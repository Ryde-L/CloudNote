<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>‰∫ëÁ¨îËÆ∞-dev-v1</title>
    <style>
        .title_div {
            position: absolute;
            left: 0;
            top: 0;
            right: 0;
            bottom: 0;
            width: 100%;
            height: 100%;
            background-color: green;
        }

        .left-div {
            position: absolute;
            left: 0;
            top: 0;
            right: 0;
            bottom: 0;
            width: 7%;
            height: 100%;
            background-color: gray;
        }

        .lef-div-inner-top {
            top: 0;
            left: 0;
            width: 100%;
            height: 80%;
            text-align: center;
        }

        .lef-div-inner-bottom {
            bottom: 0;
            left: 0;
            width: 100%;
            height: 18%;
            border: solid 1px black;
            text-align: center;
        }

        .left-icons {
            width: 50%;
            margin: 10px 0 0 0;
        }

        .center-div {
            left: 7%;
            height: 100%;
            width: 25%;
        }

        .center-notebook-div {
            position: absolute;
            left: 7%;
            top: 0;
            bottom: 0;
            height: 100%;
            width: 25%;
            overflow-y: auto;
            /*background-color: gainsboro;*/
            /*display: none;*/
        }

        .notebook-summary-and-operation-div,.recycle-bin{
            display: flex;
            justify-content: space-between;
            padding: 10px 0 0 0;
            /*margin: 10px 0 0 0;*/
            margin: 0;
            /*padding: 100px 0 0 10px;*/
        }

        .notebook-summary-div {
            display: flex;
            margin: 0 0 0 10px;
            /*padding: 0 0 0 10px*/
        }

        .notebook-operation-div {
            display: flex;
            padding: 10px 0 0 0;
            height: 30%;
            width: 35%;
            /*text-align: right;*/
        }

        .notebook-title-font {
            font-size: 16px
        }

        .notebook-number-font {
            font-size: 12px
        }

        .notebook-hr {
            /*text-align: center  ;*/
            width: 100%;
            size: 1px;
            top: 0;
            margin: 0;
            padding: 0;
        }

        .center-note-div {
            position: absolute;
            left: 7%;
            top: 0;
            bottom: 0;
            height: 100%;
            width: 25%;
            /*background-color: beige;*/
            display: none;
            overflow-y: auto;
        }
        .center-icons{
            display: flex;
            width: 20%;
            height: 20%;
            padding: 0 10px 0 0;
        }

        .right-div{
            position: absolute;
            left: 32%;
            bottom: 0;
            height: 100%;
            width: 67%;
            /*background-color: yellow;*/
        }
        .right-top-div{
            top: 0;
            width: 100%;
            height:5%;
            display: flex;
            justify-content: space-between;
            /*background-color: black;             */
        }
        .right-note-content-div{
            width: 100%;
            height:94%;
            bottom: 0;
            /*background-color: white;             */
        }
        .right-top-left-div{
            display: flex;
            margin: 10px;
        }
        .full-screen-img{
            display: flex;
            margin: 10px;
            width: 8%;
            height: 80%;
        }
        .right-icons{
            width: 10%;
            height: 100%;
            padding: 0 10px 0 0;
        }

    </style>
</head>
<div class="top-div">

    <!--  Â∑¶  -->
    <div class="left-div">
        <div class="lef-div-inner-top">
            <a href="edit.html" ><img src="../icon/un-add.png" name="over-leave" operType="icon" icon="add.png" tips="Êñ∞Âª∫Á¨îËÆ∞" class="left-icons"></a>
            <img src="../icon/un-search.png" name="over-leave" operType="icon" icon="search.png" tips="ÊêúÁ¥¢" class="left-icons" onclick="showShare()">
            <img src="../icon/un-notebook.png" name="over-leave" operType="icon" icon="notebook.png" tips="Á¨îËÆ∞Êú¨" class="left-icons" onclick="showNoteBooks()">
<!--            <img src="../icon/un-notebook.png" name="over-leave" operType="icon" icon="notebook.png" tips="Á¨îËÆ∞Êú¨" class="left-icons" onclick="showNotes(null,1)">-->
        </div>

        <div class="lef-div-inner-bottom">
            <img src="../icon/head.jpg" width="50%"
                 style="border-radius: 100px;margin: auto;top: 50%;position: relative">
        </div>
    </div>

    <!--  ‰∏≠  -->
    <div class="center-div" id="center-div">
        <!--    Á¨îËÆ∞Êú¨Áõ∏ÂÖ≥È°µÈù¢    -->
        <div class="center-notebook-div" id="center-notebook-div">
            <div style="background-color: #393d41">
                <div class="center-notebook-div-top" style="display: flex; justify-content:space-between;height: 5%; padding: 10px;">
                    <label style="padding: 10px 10px;width: 80%; display: flex;font-size: 20px;color: white">Á¨îËÆ∞Êú¨</label>
                    <img src="../icon/bookAdd.png" style="width: 10%;height: 10%;display: flex;" onclick="showCreateNoteBook()"/>
                </div>
                <div style="text-align: center;padding: 10px">
                    <input type="text" placeholder="üîçÊü•ÊâæÁ¨îËÆ∞Êú¨" style="width:90%;height:30px;text-align: center">
                </div>
            </div>
            <div id="noteBookList">
<!--                <div class="notebook-summary-and-operation-div" name="over-leave" operType="colorChange-div">-->
<!--                    <div class="notebook-summary-div">-->
<!--                        <div>-->
<!--                            <label class="notebook-title-font">ÈªòËÆ§Á¨îËÆ∞Êú¨</label><br>-->
<!--                            <label class="notebook-number-font">‰∏§Êù°Á¨îËÆ∞</label>-->
<!--                        </div>-->
<!--                    </div>-->
<!--                    <div class="notebook-operation-div">-->
<!--                        <img src="../icon/un-delete.png" name="over-leave" operType="icon" icon="delete.png" tips="Âà†Èô§" class="center-icons">-->
<!--                    </div>-->
<!--                </div>-->
<!--                <HR class="notebook-hr">-->
            </div>

            <!--     Â∫üÁ∫∏ÁØì       -->
            <div class="recycle-bin" name="over-leave" operType="colorChange-div" onclick="showRecycleBin()">
                <div class="notebook-summary-div">
                    <div>
                        <label class="notebook-title-font" style="font-size: 14px">Â∫üÁ∫∏ÁØì</label><br>
                    </div>
                </div>
                <div class="notebook-operation-div">
                    <label class="notebook-number-font"></label>
                </div>
            </div>
        </div>

        <!--    Á¨îËÆ∞Áõ∏ÂÖ≥È°µÈù¢    -->
        <div class="center-note-div" id="center-note-div">

            <!--     Ê†áÈ¢ò       -->
            <div style="height: 20%; padding: 10px 10px;display:flex;text-align: center; background-color:#393d41">
                <label style="padding: 10px 10px;font-size: 26px;width: 100%;color: white;align-self: center" id="notebook-title-label">Á¨îËÆ∞Êú¨Ê†áÈ¢ò</label>
            </div>
            <div style="margin: 5px">
                <label style="font-size: 14px;padding: 10px" ><label id="note-number-label"></label> Êù°Á¨îËÆ∞</label>
            </div>
            <HR style="margin: 0;size: 1px;width: 100%" >

            <div id="noteList">
<!--                <div class="notebook-summary-and-operation-div" name="over-leave" operType="colorChange-div" onclick="noteClicked(1)">-->
<!--                    <div class="notebook-summary-div" >-->
<!--                        <div >-->
<!--                            <label class="notebook-title-font">Á¨îËÆ∞A</label><br>-->
<!--                            <div>-->
<!--                                <label class="notebook-number-font">Ê†áÁ≠æXXXX</label>-->
<!--                                <label class="notebook-number-font">Ê†áÁ≠æYYYY</label>-->
<!--                                <label class="notebook-number-font">Ê†áÁ≠æZ</label>-->
<!--                            </div>-->
<!--                        </div>-->
<!--                    </div>-->
<!--                    <div class="notebook-operation-div">-->
<!--                        <img src="../icon/un-clock.png" name="over-leave" operType="icon" icon="clock.png" tips="ËÆæÁΩÆÊèêÈÜí" class="center-icons">-->
<!--                        <img src="../icon/un-lock.png" name="over-leave" operType="icon" icon="lock.png" tips="Âä†ÂØÜ" class="center-icons">-->
<!--                        <img src="../icon/un-delete.png" name="over-leave" operType="icon" icon="delete.png" tips="Âà†Èô§" class="center-icons">-->
<!--                        <img src="../icon/un-share.png" name="over-leave" operType="icon" icon="share.png" tips="ÂàÜ‰∫´" class="center-icons">-->
<!--                        &lt;!&ndash;                    <label>Âä†ÂØÜ</label>&ndash;&gt;-->
<!--                    </div>-->
<!--                </div>-->
<!--                <HR class="notebook-hr">-->
            </div>




        </div>

        <!--    Â∫üÁ∫∏ÁØì    -->
        <div class="center-note-div" id="center-bin-div">

            <div style="height: 20%; padding: 10px 10px;display:flex;text-align: center; background-color:#393d41">
                <label style="padding: 10px 10px;font-size: 26px;width: 100%;color: white;align-self: center">Â∫üÁ∫∏ÁØì</label>
            </div>
            <div style="margin: 5px">
                <label style="font-size: 14px;padding: 10px" ><label id="bin-note-number-label"></label>Êù°Á¨îËÆ∞</label>
            </div>
            <HR style="margin: 0;size: 1px;width: 100%" >

            <div id="bin-noteList">
                <div class="notebook-summary-and-operation-div" name="over-leave" operType="colorChange-div" onclick="binNotesClicked(1)">
                    <div class="notebook-summary-div">
                        <label class="notebook-title-font">Á¨îËÆ∞A</label>
                    </div>
                    <div class="notebook-operation-div">
                        <img src="../icon/un-clock.png" name="over-leave" operType="icon" icon="clock.png" tips="ÊÅ¢Â§ç" class="center-icons">
                        <img src="../icon/un-delete.png" name="over-leave" operType="icon" icon="delete.png" tips="Âà†Èô§" class="center-icons">
                    </div>
                </div>
                <HR class="notebook-hr">

                <div class="notebook-summary-and-operation-div" name="over-leave" operType="colorChange-div" onclick="binNotesClicked(9)">
                    <div class="notebook-summary-div">
                        <label class="notebook-title-font">Á¨îËÆ∞B</label>
                    </div>
                    <div class="notebook-operation-div">
                        <img src="../icon/un-clock.png" name="over-leave" operType="icon" icon="clock.png" tips="ÊÅ¢Â§ç" class="center-icons">
                        <img src="../icon/un-delete.png" name="over-leave" operType="icon" icon="delete.png" tips="Âà†Èô§" class="center-icons">
                    </div>
                </div>
                <HR class="notebook-hr">
            </div>

        </div>


        <!--    ÂÖ∂ÂÆÉÈ°µÈù¢    -->

    </div>


    <!--  Âè≥  -->
    <div class="right-div" id="right-div">
        <div class="right-top-div" id="right-top-div">
            <div class="right-top-left-div">
                <img src="../icon/un-clock.png" name="over-leave" operType="icon" icon="clock.png" tips="ËÆæÁΩÆÊèêÈÜí" class="right-icons">
                <img src="../icon/un-delete.png" name="over-leave" operType="icon" icon="delete.png" tips="Âà†Èô§" class="right-icons" id="note-delete-img">
                <img src="../icon/un-share.png" name="over-leave" operType="icon" icon="share.png" tips="ÂàÜ‰∫´" class="right-icons">
                <div id="tags-div"></div>
                <img src="../icon/un-tag.png" name="over-leave" operType="icon" icon="tag.png" tips="Ê∑ªÂä†Ê†áÁ≠æ" class="right-icons" onclick="showTagAdd()">

            </div>
            <img src="../icon/un-edit.png" name="over-leave" operType="icon" icon="edit.png" tips="ÁºñËæë" class="full-screen-img" onclick="editNote()">
        </div>
        <div class="right-note-content-div" id="right-note-content-div">
            <iframe src="show.html" width="100%" height="99%" id="note-show-iframe">

            </iframe>
        </div>
    </div>

</div>

<div id="share-div" style="display: none">
    <form id="share-form" onsubmit=" return false">
        <table>
            <tr>
                <td>ÊòØÂê¶ÈúÄË¶ÅÊèêÂèñÁ†Å</td>
                <td><input type="text" name="note_id" id="share-hidden-note-id" style="display: none"></td>
            </tr>
            <tr>
                <td><input type="radio" name="is_has_pwd" value="1">ÊòØ</td>
                <td><input type="radio" name="is_has_pwd" value="0">Âê¶</td>
            </tr>
            <tr>
                <td>ÂàÜ‰∫´Â§©Êï∞</td>
            </tr>
            <tr>
                <td><input type="radio" name="days" value="1">1</td>
                <td><input type="radio" name="days" value="7">7</td>
            </tr>
            <tr>
                <td><input type="submit" value="ÂàÜ‰∫´" onclick="shareSubmit()"></td>
            </tr>
        </table>
    </form>
</div>
</body>
<script type="text/javascript" src="../lib/jquery/jquery.min.js"></script>
<script type="text/javascript" src="../lib/layer/2.4/layer.js"></script>
<script type="text/javascript" src="../lib/jquery.validation/1.14.0/jquery.validate.js"></script>
<script type="text/javascript" src="../lib/jquery.validation/1.14.0/validate-methods.js"></script>
<script type="text/javascript" src="../lib/jquery.validation/1.14.0/messages_zh.js"></script>

<script>

    var currentNotebook='0';//ÂΩìÂâçÁ¨îËÆ∞Êú¨id
    var currentNote='0';//ÂΩìÂâçÁ¨îËÆ∞id
    var currentShareNote='0';
    var iconSuffix = "../icon/";

    $(function () {
        addMouseOverAndLeaveEvent();
        noteBooksAddClickEvent();
        showNoteBooks();
    });

    /*Èº†Ê†áÁßªÂÖ•ÁßªÂá∫‰∫ã‰ª∂*/
    function addMouseOverAndLeaveEvent() {
        var elements = document.getElementsByName("over-leave");
        for (var i = 0; i < elements.length; i++) {
            elements[i].addEventListener("mouseover", overs);
            elements[i].addEventListener("mouseleave", leaves);
        }
    }

    /*Èº†Ê†áÁßªÂÖ•*/
    function overs(e) {
        var type = this.getAttribute("operType");
        if (type === 'icon') {
            this.setAttribute("src", iconSuffix + this.getAttribute("icon"));
            layer.tips(this.getAttribute("tips"), this);
        } else if (type === 'colorChange-div') {
            this.style.backgroundColor = "rgba(43,181,92,0.9)";
        }

    }

    /*Èº†Ê†áÁßªÂá∫*/
    function leaves(e) {
        var type = this.getAttribute("operType");
        if (type === 'icon')
            this.setAttribute("src", iconSuffix + "un-" + this.getAttribute("icon"));
        else if (type === 'colorChange-div') {
            this.style.backgroundColor = "white";
        }
    }


    function noteBooksAddClickEvent() {
        var notebooks = document.getElementsByClassName("notebook-summary-and-operation-div");
        for (var i = 0; i < notebooks.length; i++) {
            notebooks[i].addEventListener("click", noteBooksClick)
        }
    }

    /*ÁÇπÂáªÁ¨îËÆ∞Êú¨*/
    function noteBooksClick(e) {
        console.log("Á¨îËÆ∞Êú¨ÁÇπÂáª:"+e.data.id);
        showNotes(e.data.id);
        currentNotebook=e.data.id;
    }

    function notesClicked(e){
        currentNote=e.data.id;
        document.getElementById("right-top-div").style.display='';
        document.getElementById("right-note-content-div").style.height='94%';
        document.getElementById("note-show-iframe").setAttribute("src","show.html?note="+ e.data.id);
        getTagList();
    }

    function binNotesClicked(e){
        console.log("Â∫üÁ∫∏ÁØìÁ¨îËÆ∞ÁÇπÂáªÔºö"+e.data.id);
        document.getElementById("right-top-div").style.display='none';
        document.getElementById("right-note-content-div").style.height='99%';
        document.getElementById("note-show-iframe").setAttribute("src","show.html?bin="+ e.data.id);
    }

    /*ÁºñËæëÁ¨îËÆ∞*/
    function editNote() {
        window.location.href="edit.html?note="+currentNote;
    }

    /*Â±ïÁ§∫Á¨îËÆ∞Êú¨ÂàóË°®*/
    function showNoteBooks() {
        document.getElementById("center-bin-div").style.display="none";
        document.getElementById("center-note-div").style.display="none";
        document.getElementById("center-notebook-div").style.display="block";
        getNoteBookList();
    }

    /*Â±ïÁ§∫Á¨îËÆ∞ÂàóË°®*/
    function showNotes(id) {
        document.getElementById("center-notebook-div").style.display="none";
        document.getElementById("center-bin-div").style.display="none";
        document.getElementById("center-note-div").style.display="block";
        getNoteList(id);
    }

    /*ÊòæÁ§∫Â∫üÁ∫∏ÁØì*/
    function showRecycleBin() {
        document.getElementById("center-note-div").style.display="none";
        document.getElementById("center-notebook-div").style.display="none";
        document.getElementById("center-bin-div").style.display="block";
        getBinNoteList();
    }

    /**‰ªéÂêéÂè∞Ëé∑ÂèñÁî®Êà∑Á¨îËÆ∞Êú¨*/
    function getNoteBookList() {
        $.ajax({
            url:"/noteBook/getNoteBooks",
            success:function (data) {
                if (data['isSuccessful']==='1'){
                    var noteBooksDiv=document.getElementById("noteBookList");
                    noteBooksDiv.innerHTML="";
                    for (var i = 0; i < data['data'].length; i++) {
                        var topDiv = document.createElement("div");
                        topDiv.setAttribute("class","notebook-summary-and-operation-div");
                        topDiv.setAttribute("name","over-leave");
                        topDiv.setAttribute("operType","colorChange-div");
                        $(topDiv).click({id:data['data'][i]['id']},noteBooksClick);
                        var secondDiv = document.createElement("div");
                        secondDiv.setAttribute("class","notebook-summary-div");
                        topDiv.append(secondDiv);

                        var thirdDiv = document.createElement("div");
                        secondDiv.append(thirdDiv);

                        var nameLabel = document.createElement("label");
                        nameLabel.setAttribute("class","notebook-title-font");
                        nameLabel.innerText=data['data'][i]['title'];

                        var br = document.createElement("br");

                        var numberLabel = document.createElement("label");
                        numberLabel.setAttribute("class","notebook-number-font");
                        numberLabel.innerText=data['data'][i]['noteList'].length;

                        thirdDiv.append(nameLabel);
                        thirdDiv.append(br);
                        thirdDiv.append(numberLabel);

                        var secondDiv2 = document.createElement("div");
                        secondDiv2.setAttribute("class","notebook-operation-div");
                        topDiv.append(secondDiv2);

                        var deleteImg=document.createElement("img");
                        deleteImg.setAttribute("src","../icon/un-delete.png");
                        deleteImg.setAttribute("name","over-leave");
                        deleteImg.setAttribute("operType","icon");
                        deleteImg.setAttribute("icon","delete.png");
                        deleteImg.setAttribute("tips","Âà†Èô§");
                        deleteImg.setAttribute("class","center-icons");
                        $(deleteImg).click({id:data['data'][i]['id']},noteBooksDelete);
                        secondDiv2.append(deleteImg);

                        var hr=document.createElement("HR");
                        hr.setAttribute("class","notebook-hr");
                        noteBooksDiv.append(topDiv);
                        noteBooksDiv.append(hr);
                    }
                    addMouseOverAndLeaveEvent();
                }else{
                    layer.msg("Ëé∑ÂèñÂ§±Ë¥•ÔºÅ"+data['msg']);
                }
            },
            error:function () {
                layer.msg("ÂèëÁîüÈîôËØØÔºÅ");
            }
        })
    }

    /**‰ªéÂêéÂè∞Ëé∑ÂèñÁî®Êà∑Á¨îËÆ∞*/
    function getNoteList(noteBookId) {
        $.ajax({
            url:"/noteBook/getNotesWithTags",
            data:{"note_book_id":noteBookId},
            success:function (data) {
                if (data['isSuccessful']==='1'){
                    var notesDiv=document.getElementById("noteList");
                    notesDiv.innerHTML="";
                    for (var i = 0; i < data['data']['noteList'].length; i++) {
                        console.log(i);
                        var topDiv = document.createElement("div");
                        topDiv.setAttribute("class","notebook-summary-and-operation-div");
                        topDiv.setAttribute("name","over-leave");
                        topDiv.setAttribute("operType","colorChange-div");
                        $(topDiv).click({id:data['data']['noteList'][i]['id']},notesClicked);
                        var secondDiv = document.createElement("div");
                        secondDiv.setAttribute("class","notebook-summary-div");
                        topDiv.append(secondDiv);

                        var thirdDiv = document.createElement("div");
                        secondDiv.append(thirdDiv);

                        var nameLabel = document.createElement("label");
                        nameLabel.setAttribute("class","notebook-title-font");
                        nameLabel.innerText=data['data']['noteList'][i]['title'];
                        var br = document.createElement("br");

                        var fourthDiv = document.createElement("div");

                        thirdDiv.append(nameLabel);
                        thirdDiv.append(br);
                        thirdDiv.append(fourthDiv);

                        var words=0;
                        for (var j = 0; j <data['data']['noteList'][i]['noteTagList'].length ; j++) {
                            words+=data['data']['noteList'][i]['noteTagList'][j]['tag'].length;
                            var tagLabel = document.createElement("label");
                            tagLabel.setAttribute("class","notebook-number-font");
                            tagLabel.innerText=data['data']['noteList'][i]['noteTagList'][j]['tag']+' ';
                            fourthDiv.append(tagLabel);
                            if (words>=10) {
                                tagLabel.innerText='...';
                                break;
                            }
                        }

                        var secondDiv2 = document.createElement("div");
                        secondDiv2.setAttribute("class","notebook-operation-div");
                        topDiv.append(secondDiv2);

                        var clockImg=document.createElement("img");
                        clockImg.setAttribute("name","over-leave");
                        clockImg.setAttribute("operType","icon");
                        clockImg.setAttribute("class","center-icons");
                        clockImg.setAttribute("src","../icon/un-clock.png");
                        clockImg.setAttribute("icon","clock.png");
                        clockImg.setAttribute("tips","ËÆæÁΩÆÊèêÈÜí");
                        secondDiv2.append(clockImg);

                        var lockImg=document.createElement("img");
                        lockImg.setAttribute("name","over-leave");
                        lockImg.setAttribute("operType","icon");
                        lockImg.setAttribute("class","center-icons");
                        lockImg.setAttribute("src","../icon/un-lock.png");
                        lockImg.setAttribute("icon","lock.png");
                        lockImg.setAttribute("tips","Âä†ÂØÜ");
                        secondDiv2.append(lockImg);

                        var deleteImg=document.createElement("img");
                        deleteImg.setAttribute("name","over-leave");
                        deleteImg.setAttribute("operType","icon");
                        deleteImg.setAttribute("class","center-icons");
                        deleteImg.setAttribute("src","../icon/un-delete.png");
                        deleteImg.setAttribute("icon","delete.png");
                        deleteImg.setAttribute("tips","Âà†Èô§");
                        secondDiv2.append(deleteImg);
                        $(deleteImg).click({id:data['data']['noteList'][i]['id']},notesDelete);

                        var shareImg=document.createElement("img");
                        shareImg.setAttribute("name","over-leave");
                        shareImg.setAttribute("operType","icon");
                        shareImg.setAttribute("class","center-icons");
                        shareImg.setAttribute("src","../icon/un-share.png");
                        shareImg.setAttribute("icon","share.png");
                        shareImg.setAttribute("tips","ÂàÜ‰∫´");
                        $(shareImg).click({id:data['data']['noteList'][i]['id']},showShare);

                        secondDiv2.append(shareImg);

                        var hr=document.createElement("HR");
                        hr.setAttribute("class","notebook-hr");
                        notesDiv.append(topDiv);
                        notesDiv.append(hr);
                    }
                    document.getElementById("note-number-label").innerText=data['data']['noteList'].length;
                    document.getElementById("notebook-title-label").innerText=data['data']['title'];
                    addMouseOverAndLeaveEvent();
                }else{
                    layer.msg("Ëé∑ÂèñÁ¨îËÆ∞ÂàóË°®Â§±Ë¥•ÔºÅ"+data['msg']);
                }
            },
            error:function (e) {
                var data=JSON.parse(e.responseText);
                if (data['isSuccessful']==='0'){
                    layer.msg("Ëé∑ÂèñÁ¨îËÆ∞ÂàóË°®Â§±Ë¥•ÔºÅ"+data['msg']);
                }else
                    layer.msg("ÂèëÁîüÈîôËØØÔºÅ");
            }
        })
    }

    /**‰ªéÂêéÂè∞Ëé∑ÂèñÁî®Êà∑Â∫üÁ∫∏ÁØìÁ¨îËÆ∞*/
    function getBinNoteList() {
        $.ajax({
            url:"/recycleBin/getNotes",
            success:function (data) {
                if (data['isSuccessful']==='1'){
                    var notesDiv=document.getElementById("bin-noteList");
                    notesDiv.innerHTML="";
                    for (var i = 0; i < data['data'].length; i++) {
                        var topDiv = document.createElement("div");
                        topDiv.setAttribute("class","notebook-summary-and-operation-div");
                        topDiv.setAttribute("name","over-leave");
                        topDiv.setAttribute("operType","colorChange-div");
                        $(topDiv).click({id:data['data'][i]['id']},binNotesClicked);

                        var secondDiv = document.createElement("div");
                        secondDiv.setAttribute("class","notebook-summary-div");
                        topDiv.append(secondDiv);

                        var nameLabel = document.createElement("label");
                        nameLabel.setAttribute("class","notebook-title-font");
                        nameLabel.innerText=data['data'][i]['noteTitle'];
                        secondDiv.append(nameLabel);

                        var secondDiv2 = document.createElement("div");
                        secondDiv2.setAttribute("class","notebook-operation-div");
                        topDiv.append(secondDiv2);

                        var recoverImg=document.createElement("img");
                        recoverImg.setAttribute("name","over-leave");
                        recoverImg.setAttribute("operType","icon");
                        recoverImg.setAttribute("class","center-icons");
                        recoverImg.setAttribute("src","../icon/un-recover.png");
                        recoverImg.setAttribute("icon","recover.png");
                        recoverImg.setAttribute("tips","ÊÅ¢Â§ç");
                        secondDiv2.append(recoverImg);
                        $(recoverImg).click({id:data['data'][i]['id']},noteRecover);

                        var deleteImg=document.createElement("img");
                        deleteImg.setAttribute("name","over-leave");
                        deleteImg.setAttribute("operType","icon");
                        deleteImg.setAttribute("class","center-icons");
                        deleteImg.setAttribute("src","../icon/un-delete.png");
                        deleteImg.setAttribute("icon","delete.png");
                        deleteImg.setAttribute("tips","Âà†Èô§");
                        secondDiv2.append(deleteImg);
                        $(deleteImg).click({id:data['data'][i]['id']},binNotesDelete);

                        var hr=document.createElement("HR");
                        hr.setAttribute("class","notebook-hr");
                        notesDiv.append(topDiv);
                        notesDiv.append(hr);
                    }
                    document.getElementById("bin-note-number-label").innerText=data['data'].length;
                    addMouseOverAndLeaveEvent();
                }else{
                    layer.msg("Ëé∑ÂèñÂ∫üÁ∫∏ÁØìÁ¨îËÆ∞ÂàóË°®Â§±Ë¥•ÔºÅ"+data['msg']);
                }
            },
            error:function (e) {
                var data=JSON.parse(e.responseText);
                if (data['isSuccessful']==='0'){
                    layer.msg("Ëé∑ÂèñÂ∫üÁ∫∏ÁØìÁ¨îËÆ∞ÂàóË°®Â§±Ë¥•ÔºÅ"+data['msg']);
                }else
                    layer.msg("ÂèëÁîüÈîôËØØÔºÅ");
            }
        })
    }

    /*‰ªéÂêéÂè∞Ëé∑ÂèñÁî®Êà∑Ê†áÁ≠æ*/
    function getTagList() {
        document.getElementById("tags-div").innerHTML='';

        if (currentNote==='0') return false;
        $.ajax({
            type: 'get',
            url: "/noteTag/getTags",
            data: {
                'note_id':currentNote
            },
            success: function (data) {
                if (data["isSuccessful"] === "1") {
                    for (var i = 0; i < data['data'].length; i++) {
                        var label = document.createElement('label');
                        label.innerText=data['data'][i]['tag']+' ';
                        document.getElementById("tags-div").append(label);
                    }

                }
            },
            error: function (data) {
            }
        });
    }

    /*Á¨îËÆ∞Êú¨Âà†Èô§*/
    function noteBooksDelete(e) {
        console.log("Á¨îËÆ∞Êú¨Âà†Èô§");
        $.ajax({
            url:"/noteBook/delete",
            data:{"note_book_id":e.data.id},
            async:false,
            success:function (data) {
                if (data['isSuccessful']==='1') {
                    //Âà†Èô§    ËäÇÁÇπ
                    $(e.target.parentElement.parentElement).next().remove();
                    e.target.parentElement.parentElement.remove();
                    layer.msg("Âà†Èô§ÊàêÂäüÔºÅ");
                    e.stopImmediatePropagation();
                }
                else
                    layer.msg("Âà†Èô§Â§±Ë¥•ÔºÅ"+data['msg']);
            },
            error:function (e) {
                var data=JSON.parse(e.responseText);
                if (data['isSuccessful']==='0'){
                    layer.msg("Âà†Èô§Â§±Ë¥•ÔºÅ"+data['msg']);
                }else
                    layer.msg("ÂèëÁîüÈîôËØØÔºÅ");
            }
        })
    }

    /*Á¨îËÆ∞Âà†Èô§*/
    function notesDelete(e) {
        console.log("Á¨îËÆ∞Âà†Èô§Ôºö"+e.data.id)
        $.ajax({
            url:"/recycleBin/noteThrowAway",
            data:{"note_id[]":e.data.id},
            success:function (data) {
                if (data['isSuccessful']==='1') {
                    // getNoteList(currentNotebook);
                    //Âà†Èô§    ËäÇÁÇπ
                    $(e.target.parentElement.parentElement).next().remove();
                    e.target.parentElement.parentElement.remove();
                    //‰øÆÊîπÁ¨îËÆ∞Êï∞
                    var noteNumber = document.getElementById("note-number-label");
                    noteNumber.innerText= parseInt(noteNumber.innerText)-1;
                    document.getElementById("note-show-iframe").setAttribute("src","show.html");


                    layer.msg("Âà†Èô§ÊàêÂäüÔºÅ");
                }
                else
                    layer.msg("Âà†Èô§Â§±Ë¥•ÔºÅ"+data['msg']);
            },
            error:function (e) {
                var data=JSON.parse(e.responseText);
                if (data['isSuccessful']==='0'){
                    layer.msg("Âà†Èô§Â§±Ë¥•ÔºÅ"+data['msg']);
                }else
                    layer.msg("ÂèëÁîüÈîôËØØÔºÅ");
            }
        })
    }

    /*Âà†Èô§Â∫üÁ∫∏ÁØìÁöÑÁ¨îËÆ∞*/
    function binNotesDelete(e) {
        $.ajax({
            url:"/recycleBin/delete",
            data:{"id[]":e.data.id},
            success:function (data) {
                if (data['isSuccessful']==='1') {
                    //Âà†Èô§    ËäÇÁÇπ
                    $(e.target.parentElement.parentElement).next().remove();
                    e.target.parentElement.parentElement.remove();
                    //‰øÆÊîπÁ¨îËÆ∞Êï∞
                    var noteNumber = document.getElementById("bin-note-number-label");
                    noteNumber.innerText= parseInt(noteNumber.innerText)-1;
                    layer.msg("Âà†Èô§ÊàêÂäüÔºÅ");
                }
                else
                    layer.msg("Âà†Èô§Â§±Ë¥•ÔºÅ"+data['msg']);
            },
            error:function (e) {
                var data=JSON.parse(e.responseText);
                if (data['isSuccessful']==='0'){
                    layer.msg("Âà†Èô§Â§±Ë¥•ÔºÅ"+data['msg']);
                }else
                    layer.msg("ÂèëÁîüÈîôËØØÔºÅ");
            }
        })
    }

    /*Á¨îËÆ∞ÊÅ¢Â§ç*/
    function noteRecover(e) {
        $.ajax({
            url:"/recycleBin/noteRecover",
            data:{"note_id":e.data.id},
            success:function (data) {
                if (data['isSuccessful']==='1') {
                    //Âà†Èô§    ËäÇÁÇπ
                    $(e.target.parentElement.parentElement).next().remove();
                    e.target.parentElement.parentElement.remove();
                    //‰øÆÊîπÁ¨îËÆ∞Êï∞
                    var noteNumber = document.getElementById("bin-note-number-label");
                    noteNumber.innerText= parseInt(noteNumber.innerText)-1;
                    layer.msg("ÊÅ¢Â§çÊàêÂäüÔºÅ");
                }
                else
                    layer.msg("ÊÅ¢Â§çÂ§±Ë¥•ÔºÅ"+data['msg']);
            },
            error:function (e) {
                var data=JSON.parse(e.responseText);
                if (data['isSuccessful']==='0'){
                    layer.msg("ÊÅ¢Â§çÂ§±Ë¥•ÔºÅ"+data['msg']);
                }else
                    layer.msg("ÂèëÁîüÈîôËØØÔºÅ");
            }
        })
    }

    /*ÊòæÁ§∫Á¨îËÆ∞Êú¨Ê∑ªÂä†Á™óÂè£*/
    function showCreateNoteBook() {
        layer.prompt({title: 'ËØ∑ËæìÂÖ•Á¨îËÆ∞Êú¨Âêç', formType: 0}, function(text, index){
            $.ajax({
                url:'/noteBook/add',
                async:false,
                data:{'title':text},
                success: function(data){
                    if (data['isSuccessful'] == 1){
                        layer.msg("ÂàõÂª∫ÊàêÂäü");
                        showNoteBooks();
                    } else
                        layer.msg("Â§±Ë¥•ÔºÅ"+data['msg']);
                    layer.close(index);
                },
                error:function(data) {
                    layer.msg("error!");
                    layer.close(index);
                }
            });
        });
    }

    /*ÊòæÁ§∫ÂàÜ‰∫´Á™óÂè£*/
    function showShare(e) {
        $("#share-hidden-note-id").val(e.data.id);
        layer.open({
            type: 1,
            shade: false,
            title: 'ËØ∑ÈÄâÊã©‰øùÂ≠òÂà∞ÁöÑÁ¨îËÆ∞Êú¨',
            content: $('#share-div')
        });
    }

    /*ÊòæÁ§∫Ê†áÁ≠æÊ∑ªÂä†ÁïåÈù¢*/
    function showTagAdd() {
        if (currentNote==='0') return false;
        layer.prompt({title: 'Ê∑ªÂä†Ê†áÁ≠æ', formType: 0}, function(text, index){
            layer.close(index);
            tagSubmit(text);
        });
    }

    /*Êèê‰∫§Ê†áÁ≠æ*/
    function tagSubmit(tag) {
        $.ajax({
            type: 'post',
            url: "/noteTag/addTags",
            data: {
                'note_id':currentNote,
                'tags[]':tag
            },
            success: function (data) {
                if (data["isSuccessful"] === "1") {
                    var label = document.createElement('label');
                    label.innerText=tag+' ';
                    document.getElementById("tags-div").append(label);
                } else {
                    layer.msg('Ê†áÁ≠æÊ∑ªÂä†Â§±Ë¥•!' + data["msg"], {icon: 2, time: 3500});
                }
            },
            error: function (data) {
                layer.msg('error!', {icon: 2, time: 3500});
            }
        });
    }

    /*Êèê‰∫§ÂàÜ‰∫´*/
    function shareSubmit() {
        $.ajax({
            type: 'post',
            url: "/share/create",
            data: $('#share-form').serialize(),
            success: function (data) {
                if (data["isSuccessful"] === "1") {
                    var pwd = '';
                    if (data["data"]['isHasPwd'] == 1)
                        pwd = '<br>ÊèêÂèñÁ†Å‰∏∫Ôºö' + data["data"]['pwd'];
                    document.getElementById("share-div").style.display='none';
                    layer.alert('ÂàÜ‰∫´ÂàõÂª∫ÊàêÂäü!ÈìæÊé•‰∏∫Ôºö<br>' + data["data"]['link'] + pwd);
                } else {
                    layer.msg('ÂàÜ‰∫´ÂàõÂª∫Â§±Ë¥•!' + data["msg"], {icon: 2, time: 3500});
                }
            },
            error: function (data) {
                layer.msg('error!', {icon: 2, time: 3500});
            }
        });
    }
    //ÈòªÊ≠¢ÊµèËßàÂô®ÁöÑÈªòËÆ§Ë°å‰∏∫
    function stopDefault( e ) {
        e.stopPropagation();
    }
</script>
</html>